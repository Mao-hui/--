# OpenResty/Nginx 配置示例
# 用于部署在 /official/ 子目录下的 Vue Router history 模式
# 
# 重要：此配置必须添加到服务器的 Nginx 配置文件中才能解决刷新404问题
# 配置文件位置通常在：/etc/nginx/conf.d/default.conf 或 /etc/nginx/nginx.conf

server {
    listen 80;
    server_name 119.45.45.25;
    
    # 设置根目录（根据实际部署路径调整）
    # 例如：如果网站根目录是 /var/www/html，则设置为：
    root /var/www/html;
    
    # ========== 关键配置：针对 /official/ 子目录 ==========
    location /official/ {
        # 指向实际的文件目录（必须与实际部署路径一致）
        alias /var/www/html/official/;
        
        # 关键：如果文件不存在，重定向到 index.html（这是解决刷新404的关键）
        try_files $uri $uri/ /official/index.html;
        
        # 设置默认文件
        index index.html;
    }
    
    # 静态资源缓存配置（优化性能）
    location ~* /official/static/.*\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        alias /var/www/html/official/static/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # API 代理（如果需要）
    location /api/ {
        proxy_pass http://119.45.45.25;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

# ========== 配置说明 ==========
# 1. 将上面的配置添加到 Nginx 配置文件中
# 2. 修改 root 和 alias 路径为实际部署路径
# 3. 测试配置：nginx -t
# 4. 重载配置：nginx -s reload 或 systemctl reload nginx
# 5. 验证：访问 http://119.45.45.25/official/products 并刷新，应该不再404

